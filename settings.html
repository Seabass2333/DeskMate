<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy"
        content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'">
    <title data-i18n="settingsTitle">DeskMate Settings</title>
    <link rel="stylesheet" href="src/settings.css">
</head>

<body>
    <div class="settings-container">
        <h1>âš™ï¸ <span data-i18n="settingsTitle">Settings</span></h1>

        <!-- Provider Selection -->
        <section class="settings-section">
            <h2 data-i18n="providerSection">API Provider</h2>
            <div class="form-group">
                <label for="region" data-i18n="region">Region</label>
                <select id="region">
                    <option value="china" data-i18n="regionChina">ğŸ‡¨ğŸ‡³ China</option>
                    <option value="global" data-i18n="regionGlobal">ğŸŒ Global</option>
                    <option value="local" data-i18n="regionLocal">ğŸ’» Local</option>
                </select>
            </div>

            <div class="form-group">
                <label for="provider" data-i18n="provider">Provider</label>
                <select id="provider">
                    <!-- Options populated by JS -->
                </select>
            </div>
        </section>

        <!-- API Key -->
        <section class="settings-section">
            <h2 data-i18n="apiKeySection">API Key</h2>
            <div class="form-group">
                <label for="apiKey" data-i18n="apiKey">API Key</label>
                <div class="input-with-button">
                    <input type="password" id="apiKey" placeholder="sk-xxx...">
                    <button id="toggleKey" class="btn-icon" title="Show/Hide">ğŸ‘ï¸</button>
                </div>
                <div class="help-text">
                    <small>
                        <a href="#" id="apiKeyHelpLink" class="api-key-link">
                            ğŸ‘‰ <span id="apiKeyHelpText" data-i18n="getKeyHelp">Get API Key</span>
                        </a>
                    </small>
                </div>
            </div>

            <div class="form-group">
                <label for="model" data-i18n="model">Model</label>
                <input type="text" id="model" placeholder="deepseek-chat">
            </div>

            <button id="testConnection" class="btn-secondary">
                ğŸ”— <span data-i18n="testConnection">Test Connection</span>
            </button>
            <span id="testResult" class="test-result"></span>
        </section>

        <!-- Language -->
        <section class="settings-section">
            <h2 data-i18n="interfaceLanguage">Interface Language</h2>
            <div class="form-group">
                <label for="language" data-i18n="language">Language</label>
                <select id="language">
                    <option value="zh-CN">ğŸ‡¨ğŸ‡³ ç®€ä½“ä¸­æ–‡</option>
                    <option value="en">ğŸ‡ºğŸ‡¸ English</option>
                    <option value="ja">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
                    <option value="ko">ğŸ‡°ğŸ‡· í•œêµ­ì–´</option>
                    <option value="es">ğŸ‡ªğŸ‡¸ EspaÃ±ol</option>
                    <option value="fr">ğŸ‡«ğŸ‡· FranÃ§ais</option>
                    <option value="de">ğŸ‡©ğŸ‡ª Deutsch</option>
                </select>
            </div>
        </section>

        <!-- Sound -->
        <section class="settings-section">
            <h2 data-i18n="soundSection">Sound</h2>
            <div class="form-group checkbox-group">
                <label class="checkbox-label">
                    <input type="checkbox" id="soundEnabled">
                    <span data-i18n="soundEffects">Sound Effects</span>
                </label>
            </div>
        </section>

        <!-- Timer Configuration -->
        <section class="settings-section">
            <h2 data-i18n="timerSection">Timers & Reminders</h2>

            <div class="form-group">
                <label for="pomodoroDuration" data-i18n="pomodoroDuration">Focus Duration (min)</label>
                <input type="number" id="pomodoroDuration" min="1" max="120" value="25">
            </div>

            <div class="form-group">
                <label data-i18n="reminderIntervals">Reminder Intervals (min)</label>
                <div class="grid-inputs">
                    <div class="input-suffix">
                        <label for="waterInterval">ğŸ’§ Water</label>
                        <input type="number" id="waterInterval" min="5" max="180">
                    </div>
                    <div class="input-suffix">
                        <label for="restInterval">ğŸ‘ï¸ Eyes</label>
                        <input type="number" id="restInterval" min="5" max="180">
                    </div>
                    <div class="input-suffix">
                        <label for="stretchInterval">ğŸ§˜â€â™€ï¸ Stretch</label>
                        <input type="number" id="stretchInterval" min="5" max="180">
                    </div>
                </div>
            </div>
        </section>

        <div class="settings-group">
            <h3>ğŸ¨ <span data-i18n="skinSection">Skin</span></h3>
            <select id="skin-select" class="settings-input">
                <!-- Populated dynamically -->
            </select>
            <div id="skin-preview-container" class="skin-preview-container">
                <!-- Preview image -->
            </div>
            <div id="vip-lock-msg" class="vip-lock-msg hidden">ğŸ”’ VIP Only</div>
        </div>

        <div class="settings-group">
            <h3><span data-i18n="vipSection">VIP Membership</span></h3>
            <div id="vip-status-container" class="vip-status-container">
                <div class="vip-card-header">
                    <span id="vip-status-badge" class="badge">FREE</span>
                    <p id="vip-status-text">Unlock premium skins & unlimited focus timer.</p>
                </div>

                <div class="vip-input-row" id="vip-input-container">
                    <input type="text" id="vip-code-input" placeholder="Invite Code (e.g. CAT-LOVER)" maxlength="20">
                    <button id="vip-redeem-btn" class="btn-primary" data-i18n="redeem" disabled>Redeem</button>
                </div>
                <div id="vip-message" class="vip-message"></div>
                <div id="vip-lock-msg" class="vip-lock-msg hidden">
                    <span class="lock-icon">ğŸ”’</span> <span data-i18n="vipRequired">VIP Required</span>
                </div>

                <!-- Dev Tool: Reset VIP -->
                <div style="margin-top: 10px; text-align: center;">
                    <button id="reset-vip-btn"
                        style="background: none; border: none; color: #666; font-size: 11px; cursor: pointer; text-decoration: underline;">
                        [Dev] Reset VIP
                    </button>
                </div>
            </div>
        </div>

        <!-- User Account (v1.2) -->
        <div class="settings-group" id="account-section">
            <h3 class="group-header">
                ğŸ‘¤ <span data-i18n="accountSection">Account</span>
            </h3>

            <div id="account-status-container">
                <!-- If not linked -->
                <div id="account-unlinked" class="fade-in">
                    <p class="description-text" data-i18n="accountLinkDesc">Link email to sync VIP status across
                        devices.</p>

                    <div class="email-input-group">
                        <div class="input-icon-wrapper">
                            <span class="input-icon">âœ‰ï¸</span>
                            <input type="email" id="link-email" placeholder="name@example.com"
                                class="settings-input with-icon">
                        </div>
                        <button id="send-otp-btn" class="btn-primary" data-i18n="sendCode">Send Code</button>
                    </div>
                </div>

                <!-- OTP Input (hidden by default) -->
                <div id="otp-container" class="hidden mt-4 fade-in">
                    <p class="description-text center" data-i18n="enterCodeDesc">Enter the 6-digit code sent to your
                        email.</p>
                    <div class="otp-inputs-wrapper">
                        <div class="otp-input-group">
                            <input type="text" maxlength="1" class="otp-digit" data-index="0" inputmode="numeric">
                            <input type="text" maxlength="1" class="otp-digit" data-index="1" inputmode="numeric">
                            <input type="text" maxlength="1" class="otp-digit" data-index="2" inputmode="numeric">
                            <input type="text" maxlength="1" class="otp-digit" data-index="3" inputmode="numeric">
                            <input type="text" maxlength="1" class="otp-digit" data-index="4" inputmode="numeric">
                            <input type="text" maxlength="1" class="otp-digit" data-index="5" inputmode="numeric">
                        </div>
                        <button id="verify-otp-btn" class="btn-primary full-width mt-3" data-i18n="verify"
                            disabled>Verify</button>
                    </div>
                </div>

                <!-- If linked (hidden by default) -->
                <div id="account-linked" class="hidden fade-in">
                    <div class="profile-card">
                        <div class="profile-avatar">
                            <div class="avatar-circle">ğŸ‘¤</div>
                        </div>
                        <div class="profile-info">
                            <div class="profile-email" id="linked-email">user@example.com</div>
                            <div class="profile-badges">
                                <span class="badge premium-solid">LINKED</span>
                                <!-- Feature: Show VIP badge here too if applicable -->
                            </div>
                        </div>
                        <button id="sign-out-btn" class="btn-icon-text danger" title="Sign Out">
                            â†ª
                        </button>
                    </div>
                </div>

                <div id="auth-message" class="vip-message mt-2"></div>
            </div>
        </div>

        <!-- Feedback Section (v1.3) -->
        <div class="settings-group" id="feedback-section">
            <h3 class="group-header">
                ğŸ’¬ <span data-i18n="feedbackSection">Feedback</span>
            </h3>

            <div class="form-group">
                <label for="feedback-category" data-i18n="feedbackCategory">Category</label>
                <select id="feedback-category">
                    <option value="bug">ğŸ› Bug Report</option>
                    <option value="feature">ğŸ’¡ Feature Request</option>
                    <option value="question">â“ Question</option>
                    <option value="other">ğŸ“ Other</option>
                </select>
            </div>

            <div class="form-group">
                <label for="feedback-content" data-i18n="feedbackContent">Your Feedback</label>
                <textarea id="feedback-content" rows="4" placeholder="Tell us what's on your mind..."
                    maxlength="2000"></textarea>
                <small id="feedback-char-count">0 / 2000</small>
            </div>

            <div class="form-group">
                <label for="feedback-email" data-i18n="feedbackEmail">Email (optional)</label>
                <input type="email" id="feedback-email" placeholder="your@email.com">
                <small data-i18n="feedbackEmailHint">We'll only contact you if we need more info.</small>
            </div>

            <button id="submit-feedback-btn" class="btn-primary" data-i18n="submitFeedback" disabled>Submit
                Feedback</button>
            <div id="feedback-message" class="vip-message mt-2"></div>
        </div>


        <!-- Actions -->
        <div class="actions">
            <button id="cancelBtn" class="btn-secondary" data-i18n="cancel">Cancel</button>
            <button id="saveBtn" class="btn-primary" data-i18n="save">Save</button>
        </div>
    </div>

    <script src="src/settings.js"></script>
</body>

</html>